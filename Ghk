private static void replaceFormFieldText(XWPFParagraph para, String newText) {
    boolean inFormField = false;

    for (XWPFRun run : para.getRuns()) {
        CTR ctr = run.getCTR();

        // Detect start of form field
        if (ctr.sizeOfFldCharArray() > 0 && ctr.getFldCharArray(0).getFldCharType() == STFldCharType.BEGIN) {
            inFormField = true;
        }

        // Detect FORMTEXT instruction
        if (inFormField && ctr.sizeOfInstrTextArray() > 0) {
            String instr = ctr.getInstrTextArray(0).getStringValue();
            if (instr.contains("FORMTEXT")) {
                continue; // expected, proceed
            }
        }

        // Replace text (but not field structure)
        if (inFormField && ctr.sizeOfTArray() > 0 && ctr.sizeOfInstrTextArray() == 0 && ctr.sizeOfFldCharArray() == 0) {
            for (int i = 0; i < ctr.sizeOfTArray(); i++) {
                ctr.getTArray(i).setStringValue(newText);
            }
            inFormField = false; // done with field
        }
    }
}
