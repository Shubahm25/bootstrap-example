import org.openxmlformats.schemas.wordprocessingml.x2006.main.*;

private static void updateSDTContent(XWPFSDT sdt, Map<String, String> values) {
    String title = sdt.getTitle();
    if (title != null && values.containsKey(title)) {
        try {
            String newValue = values.get(title);

            // Access the underlying XML of the SDT block
            CTSdtBlock ctSdt = sdt.getCtSdt();
            CTSdtContentBlock contentBlock = ctSdt.getSdtContent();

            // Remove all paragraphs (clean existing SDT content)
            int count = contentBlock.sizeOfPArray();
            for (int i = count - 1; i >= 0; i--) {
                contentBlock.removeP(i);
            }

            // Create new paragraph with text
            CTP newCTP = CTP.Factory.newInstance();
            CTR newCTR = newCTP.addNewR();
            CTText newText = newCTR.addNewT();
            newText.setStringValue(newValue);

            contentBlock.addNewP().set(newCTP);

        } catch (Exception e) {
            System.err.println("‚ùå Failed to update SDT '" + title + "': " + e.getMessage());
        }
    }
}
