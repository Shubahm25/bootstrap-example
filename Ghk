import org.apache.poi.xwpf.usermodel.XWPFSDT;
import org.openxmlformats.schemas.wordprocessingml.x2006.main.*;

private static void updateSDTContent(XWPFSDT sdt, Map<String, String> values) {
    String title = sdt.getTitle();
    if (title != null && values.containsKey(title)) {
        try {
            String newValue = values.get(title);

            // ✅ Correctly access the underlying inline SDT XML
            CTSdtRun ctSdtRun = sdt.getCtSdtRun();
            CTSdtContentRun content = ctSdtRun.getSdtContent();

            // Remove all existing text
            int runCount = content.sizeOfRArray();
            for (int i = runCount - 1; i >= 0; i--) {
                content.removeR(i);
            }

            // Add a new run with new text
            CTR newCTR = content.addNewR();
            CTText newText = newCTR.addNewT();
            newText.setStringValue(newValue);

        } catch (Exception e) {
            System.err.println("❌ Failed to update SDT '" + title + "': " + e.getMessage());
        }
    }
}
